<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../../../favicon.ico">

    <title>Docker: изменить рабочую директорию</title>


    <!-- Bootstrap core CSS -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="offcanvas.css" rel="stylesheet">
</head>

<body>



<div class="container">

    <div class="row row-offcanvas row-offcanvas-right">

        <div class="col-12 col-md-9">
            <p class="float-right d-md-none">
                <button type="button" class="btn btn-primary btn-sm" data-toggle="offcanvas">Toggle nav</button>
            </p>
            <div class="jumbotron">
                <h1>Docker: изменить рабочую директорию</h1>

                <br />
                <br />
                <br />
                <br />
                <br />
                <br />
                &nbsp;
                &nbsp;
                &nbsp;
                &nbsp;
                &nbsp;
                &nbsp;
                <p>Имеется Docker, установленный на системе.
                   Задача – добавить диск, перенести /var/lib/docker на этот диск,
                   что бы Docker хранил загруженные образы и остальные данные на отдельном разделе.</p>


                <p>Создаём раздел на диске либо используем существующий:</p>

                <p>Создаём каталог, монтируем:</p>


                <p><span class="alert alert-success" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">mkdir /docker &&  mount /dev/sdc1 /docker/
</span></p>
                <div class="collapse" id="collapseExample">
                    <div class="card card-body">
                        # mkdir /docker<br />
                        # mount /dev/sdc1 /docker/<br />
                    </div>
                </div>


                <p>Что бы перенести home Docker-а – создаём конфигурационный файл /etc/docker/daemon.json:</p>


                <p><span class="alert alert-success" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">mkdir /docker &&  mount /dev/sdc1 /docker/
</span></p>
                <div class="collapse" id="collapseExample">
                    <div class="card card-body">
                        root@hwlezntbao7fc000000:~# cat file
                        {
                        "graph": "/docker/"
                        }
                    </div>
                </div>

                <a href="https://rtfm.co.ua/goto/https://docs.docker.com/v1.11/engine/reference/commandline/daemon/#daemon-configuration-file">Документация.</a>

                <p>Перезапускаем, проверяем:</p>

                <p><span class="alert alert-success" data-toggle="collapse" data-target="#dockerps" aria-expanded="false" aria-controls="dockerps">  ls -l /docker/aufs/layers/
</span></p>
                <div class="collapse" id="dockerps">
                    <div class="card card-body">
                        root@hwlezntbao7fc000000:~# ls -l /docker/aufs/layers/<br/>
                        total 0<br/>
                    </div>
                </div>







                <p>Выполняем pull:</p>

                <p><span class="alert alert-success" data-toggle="collapse" data-target="#dockerps" aria-expanded="false" aria-controls="dockerps">  # docker pull nginx
</span></p>
                <div class="collapse" id="dockerps">
                    <div class="card card-body">
                        root@hwlezntbao7fc000000:~# docker pull nginx<br />
                        Using default tag: latest<br />
                        latest: Pulling from library/nginx<br />
                        693502eb7dfb: Pull complete<br />
                        6decb850d2bc: Pull complete<br />
                        c3e19f087ed6: Pull complete<br />
                        Digest: sha256:52a189e49c0c797cfc5cbfe578c68c225d160fb13a42954144b29af3fe4fe335<br />
                        Status: Downloaded newer image for nginx:latest<br />
                    </div>
                </div>

                &nbsp;
                &nbsp;
                <p>И проверяем ещё раз:</p>
                &nbsp;
                &nbsp;
                <p><span class="alert alert-success" data-toggle="collapse" data-target="#dockerpsa" aria-expanded="false" aria-controls="dockerps"> ls -l /docker/aufs/layers/


</span></p>
                <div class="collapse" id="dockerpsa">
                    <div class="card card-body">
                        root@hwlezntbao7fc000000:~# ls -l /docker/aufs/layers/<br />
                        total 8<br />
                        -rw-r--r-- 1 root root  65 Mar 13 15:48 67b3d665235e6fc550b3bd1a80da6431810101ebda8d5b84a9b615f955338526<br />
                        -rw-r--r-- 1 root root   0 Mar 13 15:48 d6f9e3f8d84c1db175dd59a24289bd225da698bd9c4e525ce9b0253d80f01041<br />
                        -rw-r--r-- 1 root root 130 Mar 13 15:48 e0a841409c7f1a485866fd57119016fdfec87030d1e60aa2e53a9d2da30836db<br />
                    </div>
                </div>
                &nbsp;
                &nbsp;



                <p>Готово.

                Для более старых (?) версий Docker – используйте файл  /etc/default/docker в Debian/Ubuntu, и /etc/sysconfig/docker – для RHEL/CentOS.

                Параметр --graph (-g) в DOCKER_OPTS, например:</p>





            </div>





            <div class="row">
                <div class="col-6 col-lg-4">
                    <h2>Task d[1][dth][1]</h2>
                    <p>
                    <ul>
                        <li>Use "example" image</li>
                        <li>Load new package for image</li>
                        <li>Save new changes</li>
                        <li>Run container and run load package command</li>
                        <li>Run container and run load package command</li>
                        <li>Create docker save example</li>
                        <li>Create docker export example</li>
                    </ul>
                    </p>

                    <p><a class="btn btn-secondary" href="/theme_l1_subtheme_task1" role="button">Show result &raquo;</a></p>
                    <p><button type="button" class="btn btn-info">Show code</button></p>
                </div><!--/span-->
            </div><!--/row-->
        </div><!--/span-->

        <div class="col-6 col-md-3 sidebar-offcanvas" id="sidebar">

            <div class="dropdown">
                <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                    Other themes
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                    <li><a href="#">Docker</a></li>
                    <li><a href="#">Drupal 8</a></li>
                    <li><a href="#">Ansible</a></li>
                    <li role="separator" class="divider">Vagrant</li>
                    <li><a href="#">DEV Ops</a></li>
                </ul>
            </div>



            <div class="list-group">





                <a href="do[1]-domain-dom[1].html" class="list-group-item">DOCKER[1] - основы докера : часть 1 – введение, установка и запуск</a>
                <a href="do[1]-domain-dom[2].html" class="list-group-item">Docker: часть 2 – управление контейнерами</a>
                <a href="do[1]-domain-dom[3].html" class="list-group-item  active">Docker: изменить рабочую директорию</a>
                <a href="#" class="list-group-item">Основы сети в Docker</a>
                <a href="#" class="list-group-item">Процесс сборки образов</a>
                <a href="#" class="list-group-item">Контейнеризация приложений</a>
                <a href="#" class="list-group-item">Основы сети в Docker</a>


            </div>
        </div><!--/span-->

        <div class="jumbotron">
            <h1>Documents and related links</h1>
            <a href="http://tuhrig.de/difference-between-save-and-export-in-docker//">http://tuhrig.de/difference-between-save-and-export-in-docker/</a>
        </div>

    </div><!--/row-->





    <hr>

    <footer>

    </footer>

</div><!--/.container-->


<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="../../../../assets/js/vendor/jquery.min.js"><\/script>')</script>
<script src="/static/js/popper.min.js"></script>
<script src="/static/js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="/static/js/ie10-viewport-bug-workaround.js"></script>
<script src="offcanvas.js"></script>
</body>
</html>